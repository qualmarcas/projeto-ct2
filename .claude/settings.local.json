{
  "permissions": {
    "allow": [
      "Bash(node:*)",
      "Bash(npx create-next-app:*)",
      "Bash(npx create-next-app@latest:*)",
      "Bash(npm install:*)",
      "Bash(npx shadcn@latest init:*)",
      "Bash(npx shadcn@latest add:*)",
      "Bash(npx tsc:*)",
      "Bash(npx supabase:*)",
      "Bash(SUPABASE_ACCESS_TOKEN=sbp_8aa328a9fa6ccf3c90f5ee8c9301fbfe0b4ea44c npx supabase init:*)",
      "Bash(SUPABASE_ACCESS_TOKEN=sbp_8aa328a9fa6ccf3c90f5ee8c9301fbfe0b4ea44c npx supabase:*)",
      "WebFetch(domain:qualmarcas.com.br)",
      "Bash(npx next build)",
      "Bash(ssh:*)",
      "Bash(curl:*)",
      "Bash(__NEW_LINE_c2f06616477725ad__ sleep 30)",
      "Bash(__NEW_LINE_c2f06616477725ad__ curl -s -X POST http://167.126.25.22:8080/instance/create -H \"apikey: 265b91cad216b00797146016405a0621\" -H \"Content-Type: application/json\" -d '{\"\"instanceName\"\":\"\"qual-marcas\"\",\"\"integration\"\":\"\"WHATSAPP-BAILEYS\"\",\"\"qrcode\"\":true}')",
      "Bash(__NEW_LINE_c2f06616477725ad__ sleep 15)",
      "Bash(__NEW_LINE_c2f06616477725ad__ ssh -i /c/Users/Administrador/.ssh/oracle-vps.key ubuntu@167.126.25.22 \"sudo docker logs evolution-api 2>&1 | grep -i -E ''qr|pair|code|connection.update|close|open'' | tail -20\")",
      "Bash(python3:*)",
      "Bash(npx vercel:*)",
      "Bash(VERCEL_ORG_ID=team_4UMAuq6egeHzhUKOWihSKZRs npx vercel link:*)",
      "Bash(test:*)",
      "Bash(ls:*)",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(supabase db push:*)",
      "Bash(source:*)",
      "Bash(NEXT_PUBLIC_SUPABASE_URL=\"https://jgmmazloujpagcweendx.supabase.co\" SUPABASE_SERVICE_ROLE_KEY=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpnbW1hemxvdWpwYWdjd2VlbmR4Iiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc3MTA3MTk1OCwiZXhwIjoyMDg2NjQ3OTU4fQ.8STyWoBB6oljinMbyCUpcgr9ytCFFvPvixlx1rECrJ8\" node:*)",
      "Bash(npm ls:*)",
      "Bash(npm run build:*)",
      "Bash(npm run lint:*)",
      "Bash(printf:*)",
      "Bash(netstat:*)",
      "Bash(taskkill:*)",
      "Bash(gh auth:*)",
      "Bash(where:*)",
      "Bash(winget list:*)",
      "Bash(winget install:*)",
      "Bash(export PATH=\"$PATH:/c/Program Files/GitHub CLI\")",
      "Bash(gh:*)",
      "Bash(cmd /c \"gh auth status\")",
      "Bash(powershell -Command \"gh auth status\":*)",
      "Bash(cmd /c \"gh auth status 2>&1\")",
      "Bash(powershell -Command \"& { gh auth status }\")",
      "Bash(\"/c/Program Files/GitHub CLI/gh.exe\" auth status)",
      "Bash(wsl bash -c \"which gh 2>/dev/null && gh auth status 2>&1 || echo ''gh nÃ£o disponÃ­vel no WSL''\")",
      "Bash(git config:*)",
      "Bash(git remote add:*)",
      "Bash(git push:*)",
      "Bash(vercel:*)",
      "Bash(export PATH=\"/c/Program Files/GitHub CLI:$PATH\")",
      "Bash(echo:*)",
      "Bash(npx eslint .)",
      "Bash(npx eslint:*)",
      "Bash(node_modules/.bin/eslint:*)",
      "Bash(node_modules/.bin/eslint .)",
      "Bash(git stash:*)",
      "Bash(git stash pop:*)",
      "Bash(node_modules/.bin/tsc:*)",
      "Bash(npx --no-install tsc:*)",
      "Bash(powershell.exe -Command \"& ''C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe'' auth status\")",
      "Bash(powershell.exe -Command \"& ''C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe'' auth login --with-token\")",
      "Bash(git checkout:*)",
      "Bash(git cherry-pick:*)",
      "Bash(powershell.exe -Command \"& ''C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe'' api repos/qualmarcas/qual-marcas --jq ''.name,.private,.visibility'' 2>&1\")",
      "Bash(powershell.exe -Command \"& ''C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe'' api user/repos --jq ''.[].full_name'' 2>&1\")",
      "Bash(powershell.exe -Command \"& ''C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe'' api user/orgs --jq ''.[].login'' 2>&1\")",
      "Bash(powershell.exe -Command \"& ''C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe'' api ''search/repositories?q=user:qualmarcas'' --jq ''.items[].full_name'' 2>&1\")",
      "Bash(powershell.exe -Command \"git config --global user.email; git config --global user.name; cmdkey /list | findstr git\")",
      "Bash(powershell.exe -Command \"& ''C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe'' pr create --base main --head feat/story-3.1 --title ''feat: WhatsApp CTA pos-diagnostico [Story 3.1]'' --body ''## Resumo\n\nImplementacao do CTA WhatsApp exibido apos o lead fornecer o email no diagnostico.\nFecha o funil: lead capturado -> conversa iniciada -> consultoria vendida.\n\n## Arquivos\n\n- qual-marcas/components/diagnostic/whatsapp-cta.tsx â€” Criado\n- qual-marcas/app/diagnostico/page.tsx â€” Modificado\n- docs/stories/3.1.story.md â€” Atualizado\n\n## Acceptance Criteria\n\n- [x] AC-1: WhatsAppCTA exibido apos onSuccess do EmailGate\n- [x] AC-2: Mensagem pre-preenchida com nome da marca\n- [x] AC-3: Numero configuravel via NEXT_PUBLIC_WHATSAPP_NUMBER\n- [x] AC-4: Link wa.me/{numero}?text={encoded}\n- [x] AC-5: Mobile nativo / desktop WhatsApp Web\n- [x] AC-6: CTA abaixo do resultado, acima do rodape\n- [x] AC-7: Fail silently sem env var\n\n## Quality Gates\n\n- Lint: 0 erros \\(52 arquivos\\)\n- TypeScript: compilado sem erros\n- Build: 12 rotas, zero warnings''\")",
      "Bash(powershell.exe -Command \"& ''C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe'' pr create --base main --head feat/story-3.2 --title ''feat: notificacao WhatsApp admin pos-lead [Story 3.2]'' --body ''## Resumo\n\nNotificacao automatica via WhatsApp para o admin \\(Alisson\\) quando um novo lead e capturado no EmailGate. Garante resposta rapida enquanto o lead esta quente.\n\n## Arquivos\n\n| Arquivo | Operacao |\n|---------|----------|\n| qual-marcas/lib/whatsapp/notify-admin.ts | Criado |\n| qual-marcas/app/api/lead/route.ts | Modificado |\n| docs/stories/3.2.story.md | Atualizado |\n\n## Acceptance Criteria\n\n- [x] AC-1: Notificacao disparada apos salvar lead em /api/lead\n- [x] AC-2: Mensagem com nome, email, marca diagnosticada e score de risco\n- [x] AC-3: ADMIN_WHATSAPP_NUMBER configuravel via env var\n- [x] AC-4: Evolution API existente reutilizada \\(IDS REUSE\\)\n- [x] AC-5: Fire-and-forget via .catch\\(\\) â€” HTTP nunca bloqueado\n- [x] AC-6: Erros logados com contexto \\(clientId, err\\)\n- [x] AC-7: Skip silencioso quando ADMIN_WHATSAPP_NUMBER ausente\n\n## Quality Gates\n\n- Lint: 0 erros\n- TypeScript: compilado sem erros\n- Build: 12 rotas, zero warnings\n\nðŸ¤– Generated with [Claude Code]\\(https://claude.com/claude-code\\)''\")",
      "Bash(powershell.exe -Command \"& ''C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe'' pr create --base main --head feat/story-3.4 --title ''feat: campo telefone opcional no lead [Story 3.4]'' --body ''## Resumo\n\nCampo WhatsApp opcional no EmailGate para o visitante informar seu telefone, aumentando canais de contato apos o diagnostico.\n\n## Arquivos\n\n| Arquivo | Operacao |\n|---------|----------|\n| qual-marcas/components/diagnostic/email-gate.tsx | Modificado |\n| qual-marcas/lib/ai/schema/diagnostic.schema.ts | Modificado |\n| qual-marcas/lib/db/diagnostics.ts | Modificado |\n| qual-marcas/app/api/lead/route.ts | Modificado |\n| qual-marcas/supabase/migrations/005_add_phone_status_to_clients.sql | Criado |\n\n## Acceptance Criteria\n\n- [x] AC-1: Campo WhatsApp \\(opcional\\) no EmailGate, abaixo do email\n- [x] AC-2: Nao obrigatorio â€” submissao funciona sem preenchimento\n- [x] AC-3: Aceita formatos: \\(11\\) 99999-9999, 11999999999, +5511999999999\n- [x] AC-4: Normalizado \\(55XXXXXXXXXXX\\) em clients.phone\n- [x] AC-5: Migration 005 consolidada \\(phone + status para Story 3.3\\)\n- [x] AC-6: Schema Zod leadInputSchema com phone opcional\n- [x] AC-7: findOrCreateClient salva phone normalizado\n\n## Quality Gates\n\n- Lint: 0 erros\n- TypeScript: compilado sem erros\n- Build: 12 rotas, zero warnings\n\nðŸ¤– Generated with [Claude Code]\\(https://claude.com/claude-code\\)''\")",
      "Bash(GIT_EDITOR=true git cherry-pick:*)",
      "Bash(powershell.exe -Command \"& ''C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe'' pr create --base main --head feat/story-3.3 --title ''feat: pipeline /admin de leads [Story 3.3]'' --body ''## Resumo\n\nPagina /admin protegida por senha onde Alisson visualiza todos os leads, diagnosticos e pode atualizar o status de acompanhamento. Fecha o Epic 3 â€” Pipeline de Conversao.\n\n## Arquivos\n\n| Arquivo | Operacao |\n|---------|----------|\n| qual-marcas/lib/admin/auth.ts | Criado |\n| qual-marcas/app/admin/page.tsx | Criado |\n| qual-marcas/app/admin/login/page.tsx | Criado |\n| qual-marcas/app/admin/layout.tsx | Criado |\n| qual-marcas/app/admin/_components/leads-table.tsx | Criado |\n| qual-marcas/app/admin/_components/logout-button.tsx | Criado |\n| qual-marcas/app/api/admin/auth/route.ts | Criado |\n| qual-marcas/app/api/admin/leads/route.ts | Criado |\n| qual-marcas/app/api/admin/leads/[id]/route.ts | Criado |\n| qual-marcas/supabase/migrations/005_add_phone_status_to_clients.sql | Atualizado |\n\n## Acceptance Criteria\n\n- [x] AC-1: /admin protegido, redireciona para /admin/login\n- [x] AC-2: Login com ADMIN_PASSWORD, cookie httpOnly 24h\n- [x] AC-3: Tabela: Nome, Email, WhatsApp, Marca, Risco, Data, Status\n- [x] AC-4: Badge de risco colorido \\(verde/amarelo/vermelho\\)\n- [x] AC-5: Status editavel inline via dropdown\n- [x] AC-6: Ordenacao mais recentes primeiro\n- [x] AC-7: Botao WhatsApp por lead com mensagem personalizada\n- [x] AC-8: Responsivo \\(smartphone\\)\n- [x] AC-9: PATCH /api/admin/leads/[id] atualiza Supabase\n- [x] AC-10: Migration 005 com status DEFAULT novo\n\n## Quality Gates\n\n- Lint: 0 erros \\(todos os arquivos\\)\n- TypeScript: compilado sem erros\n- Build: 15 rotas, zero warnings\n\nðŸ¤– Generated with [Claude Code]\\(https://claude.com/claude-code\\)''\")",
      "Bash(powershell.exe -Command \"Get-Content ''C:\\\\Users\\\\Administrador\\\\meu-projeto\\\\qual-marcas\\\\supabase\\\\.temp\\\\project-ref''\")",
      "Bash(powershell.exe -Command \"Get-Content ''C:\\\\Users\\\\Administrador\\\\meu-projeto\\\\qual-marcas\\\\.env.local'' | Select-String ''SUPABASE''\")",
      "Bash(powershell.exe -Command \"& ''C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe'' pr merge 1 --squash --delete-branch --repo qualmarcas/qual-marcas\")",
      "Bash(powershell.exe -Command \"& ''C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe'' pr merge 2 --squash --delete-branch --repo qualmarcas/qual-marcas\")",
      "Bash(powershell.exe -Command \"& ''C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe'' pr merge 3 --squash --delete-branch --repo qualmarcas/qual-marcas\")",
      "Bash(powershell.exe -Command \"& ''C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe'' pr merge 4 --squash --delete-branch --repo qualmarcas/qual-marcas\")",
      "Bash(powershell.exe -Command \"& ''C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe'' pr list --repo qualmarcas/qual-marcas\")",
      "Bash(powershell.exe -Command \"& ''C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe'' pr view 2 --repo qualmarcas/qual-marcas --json state,mergeable,mergeStateStatus\")",
      "Bash(powershell.exe -Command \"& ''C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe'' pr view 3 --repo qualmarcas/qual-marcas --json state,mergeable,mergeStateStatus\")",
      "Bash(powershell.exe -Command \"& ''C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe'' pr view 4 --repo qualmarcas/qual-marcas --json state,mergeable,mergeStateStatus\")",
      "Bash(powershell.exe -Command \"& ''C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe'' pr close 3 --repo qualmarcas/qual-marcas --comment ''Fechando: codigo ja incorporado ao main via push direto. Branch feat/story-3.4 pode ser deletada.'' --delete-branch\")",
      "Bash(powershell.exe -Command \"& ''C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe'' pr close 4 --repo qualmarcas/qual-marcas --comment ''Fechando: codigo ja incorporado ao main via push direto. Branch feat/story-3.3 pode ser deletada.'' --delete-branch\")",
      "Bash(powershell.exe -Command \"& ''C:\\\\Program Files\\\\GitHub CLI\\\\gh.exe'' pr list --repo qualmarcas/qual-marcas --state all\")",
      "Bash(git fetch:*)",
      "Bash(git rebase:*)",
      "Bash(powershell.exe -Command \"Copy-Item ''C:\\\\Users\\\\Administrador\\\\Downloads\\\\Shot\\\\Assetsvisuais\\\\Qual3.png'' ''C:\\\\Users\\\\Administrador\\\\meu-projeto\\\\qual-marcas\\\\public\\\\logo-qual.png''; Copy-Item ''C:\\\\Users\\\\Administrador\\\\Downloads\\\\Shot\\\\Assetsvisuais\\\\Qual1.png'' ''C:\\\\Users\\\\Administrador\\\\meu-projeto\\\\qual-marcas\\\\public\\\\logo-icon.png''; Write-Host OK\")",
      "Bash(powershell.exe -Command \"Get-ChildItem ''C:\\\\Users\\\\Administrador\\\\Downloads\\\\shot\\\\Assetsvisuais'' | Select-Object Name\")",
      "Bash(powershell.exe -Command \"Copy-Item ''C:\\\\Users\\\\Administrador\\\\Downloads\\\\shot\\\\Assetsvisuais\\\\qual2-1.png'' ''C:\\\\Users\\\\Administrador\\\\meu-projeto\\\\qual-marcas\\\\public\\\\logo-qual.png'' -Force\")",
      "Bash(npx playwright:*)",
      "Bash(npx --yes playwright:*)",
      "Bash(dir:*)",
      "Bash(powershell -Command \"Get-ChildItem ''C:\\\\Users\\\\Administrador\\\\Downloads\\\\'' -Filter ''screenshot*'' | Select-Object Name, Length, LastWriteTime\")",
      "Bash(npx:*)"
    ]
  },
  "hooks": {
    "UserPromptSubmit": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "node \".claude/hooks/synapse-engine.js\""
          }
        ]
      }
    ]
  }
}
